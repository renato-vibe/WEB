<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Servicios — Solomon Labs</title>
  <link rel="icon" href="fav.png" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,Cantarell,"Noto Sans",Arial}
    .service{transition:transform .25s ease, box-shadow .25s ease, border-color .25s ease}
    .service:hover,.service:focus-within{transform:translateY(-2px) scale(1.01);box-shadow:0 20px 45px rgba(0,0,0,.08)}
    .anim-box{position:relative;border-radius:1rem;background:#fff;overflow:hidden;min-height:12rem;border:1px solid #e5e5e5}
    .anim-box canvas{position:absolute;inset:0;width:100%;height:100%;display:block}
    #hero { will-change: transform, opacity; transform-origin: center top; }
  </style>
</head>
<body class="bg-white text-zinc-900 antialiased">

<!-- Header -->
<header class="container mx-auto px-6 py-4 flex items-center justify-between">
  <!-- Logo / Inicio -->
  <a class="inline-flex items-center gap-3 focus:ring-2 focus:ring-zinc-300 rounded-md" href="/" aria-label="Inicio — Solomon Labs">
    <img src="solomon.png" alt="Solomon Labs" class="w-9 h-9">
    <span class="text-xl font-extrabold tracking-tight">Solomon Labs</span>
  </a>

  <!-- Desktop nav -->
  <nav class="hidden sm:flex items-center gap-1">
    <a href="/"           class="text-sm text-zinc-700 hover:text-black px-3 py-2 rounded-md">Inicio</a>
    <a href="/servicios"  class="text-sm text-zinc-900 font-semibold px-3 py-2 rounded-md" aria-current="page">Servicios</a>
    <a href="/casos"      class="text-sm text-zinc-700 hover:text-black px-3 py-2 rounded-md">Casos</a>
    <a href="/contacto"   class="text-sm text-zinc-700 hover:text-black px-3 py-2 rounded-md">Contacto</a>

    <!-- Idioma (placeholder) -->
    <button type="button"
            class="ml-1 inline-flex items-center gap-2 rounded-full border border-zinc-300 px-3 py-1.5 text-xs font-medium text-zinc-700 hover:bg-zinc-50"
            aria-label="Cambiar idioma (ENG/ESP)">
      ENG / ESP
    </button>
  </nav>

  <!-- Mobile: hamburger -->
  <button id="nav-toggle"
          class="sm:hidden inline-flex items-center justify-center w-10 h-10 rounded-md border border-zinc-300 text-zinc-700 hover:bg-zinc-50"
          aria-expanded="false" aria-controls="mobile-nav" aria-label="Abrir menú">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
    </svg>
  </button>
</header>

<!-- Mobile menu panel -->
<nav id="mobile-nav" class="sm:hidden hidden container mx-auto px-6 pb-4">
  <div class="mt-2 rounded-xl border border-zinc-200 bg-white shadow-sm overflow-hidden">
    <a href="/"           class="block px-4 py-3 text-sm text-zinc-800 hover:bg-zinc-50">Inicio</a>
    <a href="/servicios"  class="block px-4 py-3 text-sm font-semibold text-zinc-900 bg-zinc-50">Servicios</a>
    <a href="/casos"      class="block px-4 py-3 text-sm text-zinc-800 hover:bg-zinc-50">Casos</a>
    <a href="/contacto"   class="block px-4 py-3 text-sm text-zinc-800 hover:bg-zinc-50">Contacto</a>
    <div class="border-t border-zinc-200"></div>
    <button type="button"
            class="w-full text-left px-4 py-3 text-sm text-zinc-800 hover:bg-zinc-50"
            aria-label="Cambiar idioma (ENG/ESP)">
      ENG / ESP
    </button>
  </div>
</nav>

<script>
  // Toggle simple del menú móvil
  (function() {
    const btn = document.getElementById('nav-toggle');
    const panel = document.getElementById('mobile-nav');
    if (!btn || !panel) return;
    btn.addEventListener('click', () => {
      const isHidden = panel.classList.toggle('hidden');
      btn.setAttribute('aria-expanded', String(!isHidden));
    });
    window.addEventListener('resize', () => {
      if (window.innerWidth >= 640 && !panel.classList.contains('hidden')) {
        panel.classList.add('hidden'); btn.setAttribute('aria-expanded', 'false');
      }
    }, { passive: true });
  })();
</script>

<main id="top">
  <!-- HERO -->
  <section id="hero" class="container mx-auto px-6">
    <div class="flex gap-6 md:gap-8 py-20 md:py-[7.5rem] items-center justify-center flex-col text-center">
      <p class="inline-flex items-center gap-2 rounded-full border border-zinc-200 bg-zinc-100/60 px-4 py-2 text-xs md:text-sm text-zinc-700">
        Servicios Solomon Labs
      </p>
      <h1 class="text-4xl md:text-6xl tracking-tighter font-extrabold">Prototipado y entrega exprés</h1>
      <p class="text-lg md:text-xl leading-relaxed tracking-tight text-zinc-600 max-w-2xl">
        Ideamos, refinamos y difundimos. Websites, Apps, Agentes IA y módulos SaaS listos para validar.
      </p>
    </div>
  </section>

<!-- SERVICIOS (3 bloques) — shaders alineados y SIEMPRE contenidos en su widget -->
<section id="servicios" class="container mx-auto px-6 pb-20 md:pb-28">
  <h2 class="text-2xl md:text-3xl font-extrabold mb-6 flex items-center gap-3">
    <img src="solomon.png" alt="" class="w-7 h-7">
    Qué hacemos
  </h2>

  <style>
    /* Tarjeta contenedora: recorta cualquier desborde del shader */
    #servicios .service{
      position: relative;
      height: 100%;
      overflow: hidden;          /* <- evita que el canvas se salga del widget */
      border-radius: 0.75rem;    /* igual a rounded-xl */
      isolation: isolate;        /* asegura stacking dentro de la tarjeta */
    }
    /* Layout interno: texto arriba, espacio flexible, shader abajo */
    #servicios .service-grid{
      display: grid;
      grid-template-rows: auto 1fr auto;
      gap: 1rem;
      min-height: 100%;
    }
    #servicios .service .copy{align-self:start}
    #servicios .service .spacer{min-height:0}

    /* Caja del shader: también recorta y nunca desborda */
    #servicios .anim-box{
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;      /* altura uniforme */
      background: #fff;
      border: 1px solid rgba(0,0,0,.08);
      border-radius: 0.75rem;
      overflow: hidden;          /* <- clip adicional en el nivel del shader */
      z-index: 0;
    }
    #servicios .anim-box canvas{
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
    }
  </style>

  <div class="grid lg:grid-cols-3 gap-6 items-stretch">
    <!-- Ideación -->
    <article class="service p-5 md:p-6 border border-zinc-200/70 bg-white">
      <div class="service-grid">
        <div class="copy">
          <h3 class="text-xl font-bold">Ideación</h3>
          <p class="text-zinc-600 mt-2 max-w-prose">
            Exploramos opciones y aterrizamos oportunidades en prototipos claros. Definimos el mínimo valioso, riesgos y métricas.
          </p>
          <ul class="mt-4 text-sm text-zinc-600 grid grid-cols-2 gap-2 max-w-xl">
            <li>Hipótesis & métricas</li><li>Blueprint MVP</li>
            <li>Mapa de valor</li><li>Plan de prueba</li>
          </ul>
        </div>
        <div class="spacer"></div>
        <div class="anim-box" aria-label="Ideación — cubos flotando">
          <canvas id="cv-idea"></canvas>
        </div>
      </div>
    </article>

    <!-- Refinamiento -->
    <article class="service p-5 md:p-6 border border-zinc-200/70 bg-white">
      <div class="service-grid">
        <div class="copy">
          <h3 class="text-xl font-bold">Refinamiento</h3>
          <p class="text-zinc-600 mt-2 max-w-prose">
            Pulimos UX, rendimiento y costes. Reducimos complejidad y hacemos que todo “se sienta” rápido y sólido.
          </p>
          <ul class="mt-4 text-sm text-zinc-600 grid grid-cols-2 gap-2 max-w-xl">
            <li>Auditoría UX</li><li>Performance</li>
            <li>Hardening</li><li>Observabilidad</li>
          </ul>
        </div>
        <div class="spacer"></div>
        <div class="anim-box" aria-label="Refinamiento — cubo giro/pausa">
          <canvas id="cv-refine"></canvas>
        </div>
      </div>
    </article>

    <!-- Difusión -->
    <article class="service p-5 md:p-6 border border-zinc-200/70 bg-white">
      <div class="service-grid">
        <div class="copy">
          <h3 class="text-xl font-bold">Difusión</h3>
          <p class="text-zinc-600 mt-2 max-w-prose">
            Hacemos visible el valor: micrositios, motion y pitch con copy claro para decisión y adopción rápida.
          </p>
          <ul class="mt-4 text-sm text-zinc-600 grid grid-cols-2 gap-2 max-w-xl">
            <li>Micrositio/Pitch</li><li>Motion/UI</li>
            <li>Brand basics</li><li>Assets sociales</li>
          </ul>
        </div>
        <div class="spacer"></div>
        <div class="anim-box" aria-label="Difusión — aro de cubos">
          <canvas id="cv-diffuse"></canvas>
        </div>
      </div>
    </article>
  </div>

  <div class="mt-10 text-center">
  <a href="/contacto"
     class="inline-flex items-center gap-2 rounded-xl bg-zinc-900 text-white px-6 py-3 text-base hover:bg-black focus:outline-none focus:ring-2 focus:ring-zinc-300"
     aria-label="Ir a la sección de contacto para hablar sobre tu reto">
    Hablemos de tu reto
  </a>
</div>
</section>

<script>
/* Igualador de alturas: mantiene los shaders a la MISMA altura entre tarjetas
   sin permitir que nada se salga del contenedor. */
(function(){
  const scope = document.getElementById('servicios');
  if(!scope) return;

  const copies  = Array.from(scope.querySelectorAll('.service .copy'));
  const spacers = Array.from(scope.querySelectorAll('.service .spacer'));

  function align(){
    spacers.forEach(s=>s.style.minHeight='0px');
    const maxH = Math.max(...copies.map(c=>c.getBoundingClientRect().height));
    copies.forEach((c,i)=>{
      const diff = Math.max(0, maxH - c.getBoundingClientRect().height);
      spacers[i].style.minHeight = diff + 'px';
    });
  }

  const ro = new ResizeObserver(align);
  copies.forEach(c=>ro.observe(c));
  window.addEventListener('load', align, {once:true});
  window.addEventListener('resize', align, {passive:true});
})();
</script>

<!-- ENTREGABLES (por tipo) — versión con UN solo frame por widget -->
<section id="entregables" class="container mx-auto px-6 pb-20 md:pb-28">
  <h2 class="text-2xl md:text-3xl font-extrabold mb-6">Entregables</h2>

  <style>
    /* Canvas full-bleed dentro del ÚNICO frame del widget */
    .deliverable-media{position:relative; aspect-ratio:16/9; overflow:hidden; border-radius:0.875rem; background:#f4f4f5}
    .deliverable-media canvas{position:absolute; inset:0; width:100%; height:100%; display:block}
  </style>

  <div class="grid md:grid-cols-3 gap-6">
    <!-- Websites -->
    <article class="service p-5 md:p-6 rounded-xl border border-zinc-200/70 bg-white h-full">
      <div class="flex flex-col gap-4 h-full">
        <!-- ÚNICO frame: el del widget (article). El canvas NO dibuja marcos. -->
        <div class="deliverable-media" id="wrap-websites">
          <canvas id="cv-websites" aria-label="Websites preview"></canvas>
        </div>
        <div>
          <h3 class="text-xl font-bold">Websites</h3>
          <p class="text-zinc-600 mt-2">Landing y sitios de producto rápidos, accesibles y medibles.</p>
        </div>
        <div class="mt-auto">
        </div>
      </div>
    </article>

    <!-- Apps -->
    <article class="service p-5 md:p-6 rounded-xl border border-zinc-200/70 bg-white h-full">
      <div class="flex flex-col gap-4 h-full">
        <div class="deliverable-media" id="wrap-apps">
          <canvas id="cv-apps" aria-label="Apps preview"></canvas>
        </div>
        <div>
          <h3 class="text-xl font-bold">Apps</h3>
          <p class="text-zinc-600 mt-2">Web apps y microfronts con performance y DX impecables.</p>
        </div>
        <div class="mt-auto">
        </div>
      </div>
    </article>

    <!-- Agentes IA -->
    <article class="service p-5 md:p-6 rounded-xl border border-zinc-200/70 bg-white h-full">
      <div class="flex flex-col gap-4 h-full">
        <div class="deliverable-media" id="wrap-agentes">
          <canvas id="cv-agentes" aria-label="Agentes IA preview"></canvas>
        </div>
        <div>
          <h3 class="text-xl font-bold">Agentes IA</h3>
          <p class="text-zinc-600 mt-2">Workflows y copilotos conectados a tus datos y APIs.</p>
        </div>
        <div class="mt-auto">
        </div>
      </div>
    </article>

    <!-- Módulos SaaS -->
    <article class="service p-5 md:p-6 rounded-xl border border-zinc-200/70 bg-white h-full">
      <div class="flex flex-col gap-4 h-full">
        <div class="deliverable-media" id="wrap-saas">
          <canvas id="cv-saas" aria-label="Módulos SaaS preview"></canvas>
        </div>
        <div>
          <h3 class="text-xl font-bold">Módulos SaaS</h3>
          <p class="text-zinc-600 mt-2">Add-ons de pago, auth, billing, analytics y más.</p>
        </div>
        <div class="mt-auto">
        </div>
      </div>
    </article>

    <!-- Implementación -->
    <article class="service p-5 md:p-6 rounded-xl border border-zinc-200/70 bg-white h-full opacity-90">
      <div class="flex flex-col gap-4 h-full">
        <div class="deliverable-media" id="wrap-impl">
          <canvas id="cv-impl" aria-label="Implementación preview"></canvas>
        </div>
        <div>
          <h3 class="text-xl font-bold">Implementación</h3>
          <p class="text-zinc-600 mt-2">Despliegues y adopción de software existente, con foco en valor.</p>
        </div>
        <div class="mt-auto">
        </div>
      </div>
    </article>
  </div>

  <!-- CTA inferior -->
<div class="mt-10 text-center">
  <a href="/casos"
     class="inline-flex items-center justify-center rounded-xl bg-zinc-900 text-white px-6 py-3 text-base hover:bg-black focus:outline-none focus:ring-2 focus:ring-zinc-300"
     aria-label="Ver casos de éxito">
    Ver casos
  </a>
</div>
</section>

<script>
/* ============================================================
   ENTREGABLES con imágenes: un SOLO frame (el del widget)
   - El canvas NO agrega bordes ni marcos: sólo recorta y dibuja la foto.
   - Micro-zoom muy sutil en hover/visibilidad, sin paneo (no aparecen márgenes).
   ============================================================ */
(function(){
  const sources = {
  "cv-websites": "./websites.png",
  "cv-apps":     "./apps.png",
  "cv-agentes":  "https://plus.unsplash.com/premium_photo-1683121718643-fb18d2668d53?q=80&w=2532&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
  "cv-saas":     "https://images.unsplash.com/photo-1634848577969-bc28ee71ffc1?q=80&w=1964&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
  "cv-impl":     "./proyectos.png"
};

  const canHover = matchMedia("(hover:hover) and (pointer:fine)").matches;

  function setup(canvas){
    const ctx = canvas.getContext("2d");
    function fit(){
      const dpr = Math.min(2, window.devicePixelRatio || 1);
      const r = canvas.getBoundingClientRect();
      const w = Math.max(1, (r.width  * dpr) | 0);
      const h = Math.max(1, (r.height * dpr) | 0);
      if (canvas.width !== w || canvas.height !== h) { canvas.width = w; canvas.height = h; }
    }
    fit(); addEventListener("resize", fit, {passive:true});
    return { ctx, fit };
  }

  function drawCover(ctx, img, x, y, w, h, scale){
    // Clip a la caja del widget (único frame)
    const r = 14; // radio visual del contenedor (de la clase .deliverable-media)
    const R = Math.min(r, w/2, h/2);
    ctx.save();
    ctx.beginPath();
    ctx.moveTo(x+R,y);
    ctx.arcTo(x+w,y, x+w,y+h, R);
    ctx.arcTo(x+w,y+h, x,y+h, R);
    ctx.arcTo(x,y+h, x,y, R);
    ctx.arcTo(x,y, x+w,y, R);
    ctx.clip();

    // cover sin paneo
    const iw = img.naturalWidth, ih = img.naturalHeight;
    const arImg = iw/ih, arBox = w/h;
    let dw, dh;
    if (arImg > arBox) { dh = h*scale; dw = dh*arImg; }
    else { dw = w*scale; dh = dw/arImg; }
    const sx = x + (w - dw)/2;
    const sy = y + (h - dh)/2;

    ctx.filter = "saturate(0.92) contrast(1.03)";
    ctx.drawImage(img, sx, sy, dw, dh);
    ctx.restore();
  }

  Object.keys(sources).forEach((id)=>{
    const canvas = document.getElementById(id);
    if(!canvas) return;

    const { ctx, fit } = setup(canvas);
    const img = new Image();
    img.crossOrigin = "anonymous";
    img.src = sources[id];

    let active = false, t0 = 0, raf = 0;
    function render(t){
      if(!img.complete){ raf = requestAnimationFrame(render); return; }
      fit();
      const W = canvas.width, H = canvas.height;
      ctx.clearRect(0,0,W,H);

      const pad = 0; // full-bleed dentro del ÚNICO frame del widget
      const x = pad, y = pad, w = W - pad*2, h = H - pad*2;

      const baseScale = 1.022; // pequeño overscan para no mostrar márgenes
      let scale = baseScale;
      if (active){
        const tt = (t - t0) * 0.0011;
        scale = baseScale + 0.005*(0.5 + 0.5*Math.sin(tt)); // micro-zoom 0.5%
      }

      drawCover(ctx, img, x,y,w,h, scale);

      raf = requestAnimationFrame(render);
    }

    const wrap = canvas.parentElement; // .deliverable-media
    const card = canvas.closest(".service") || wrap;

    if (canHover) {
      card.addEventListener("pointerenter", ()=>{ active = true; t0 = performance.now(); }, {passive:true});
      card.addEventListener("pointerleave", ()=>{ active = false; }, {passive:true});
    }

    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting && e.intersectionRatio > 0.95){ active = true; t0 = performance.now(); }
        else if(e.intersectionRatio < 0.7){ active = false; }
      });
    }, {threshold:[0,.7,.95,1]});
    io.observe(card);
    addEventListener("beforeunload", ()=>io.disconnect(), {once:true});

    img.onload = ()=>{ cancelAnimationFrame(raf); raf = requestAnimationFrame(render); };
    raf = requestAnimationFrame(render);
  });
})();
</script>




  <!-- FOOTER -->
<footer id="contacto" class="border-t border-zinc-200/70 py-10">
  <div class="container mx-auto px-6 flex flex-col md:flex-row items-center md:items-start justify-between gap-6">
    <div class="flex items-center gap-3">
      <img src="solomon.png" alt="Logo Solomon Labs" class="w-8 h-8">
      <strong>Solomon Labs</strong>
    </div>
    <p class="text-zinc-600">¿Tienes un reto? En 30&nbsp;min trazamos el primer sprint.</p>
    <a href="/contacto"
       class="inline-flex items-center gap-2 rounded-xl bg-zinc-900 text-white px-5 py-2.5 hover:bg-black focus:outline-none focus:ring-2 focus:ring-zinc-300"
       aria-label="Agenda una llamada con Solomon Labs">
      Agenda una llamada
    </a>
  </div>
</footer>
</main>

<!-- ====== Animaciones Canvas 2D: tetraedros wireframe (fondo blanco, grafito #222) ====== -->
<script>
(function(){
  const DARK = '#222';

  function makeCanvasRunner(canvas, drawFrame){
    const ctx = canvas.getContext('2d');
    let raf = 0;

    function fit(){
      const dpr = Math.min(2, window.devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      const w = Math.max(1, Math.floor(rect.width * dpr));
      const h = Math.max(1, Math.floor(rect.height * dpr));
      if (canvas.width !== w || canvas.height !== h) { canvas.width = w; canvas.height = h; }
    }

    function loop(t){
      fit();
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#fff';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.save();
      drawFrame(ctx, canvas, t);
      ctx.restore();
      raf = requestAnimationFrame(loop);
    }

    addEventListener('resize', fit, {passive:true});
    fit(); raf = requestAnimationFrame(loop);
    return { stop(){ cancelAnimationFrame(raf); } };
  }

  // --- util 3D ortho (caras SIEMPRE del mismo tamaño) ---
  function rotX([x,y,z], a){ const c=Math.cos(a), s=Math.sin(a); return [x, y*c - z*s, y*s + z*c]; }
  function rotY([x,y,z], a){ const c=Math.cos(a), s=Math.sin(a); return [x*c + z*s, y, -x*s + z*c]; }
  function rotZ([x,y,z], a){ const c=Math.cos(a), s=Math.sin(a); return [x*c - y*s, x*s + y*c, z]; }
  function add([x,y,z],[dx,dy,dz]){ return [x+dx,y+dy,z+dz]; }
  function mul([x,y,z],k){ return [x*k,y*k,z*k]; }
  function projOrtho([x,y], w, h, scale){ return [w/2 + x*scale, h/2 + y*scale]; }
  const easeInOutSine = (x)=>-(Math.cos(Math.PI*x)-1)/2;

  // Cubo wireframe
  const V = [
    [-1,-1,-1],[ 1,-1,-1],[ 1, 1,-1],[-1, 1,-1],
    [-1,-1, 1],[ 1,-1, 1],[ 1, 1, 1],[-1, 1, 1]
  ];
  const E = [[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];

  function computeVerts(pos, rot, scale, w, h){
    const S = Math.min(w,h)*0.07*scale;
    return V.map(p=>{
      let q = mul(p, 1);
      q = rotX(q, rot[0]); q = rotY(q, rot[1]); q = rotZ(q, rot[2]);
      q = add(q, pos);
      return projOrtho(q, w, h, S);
    });
  }

  function strokeEdges(ctx, verts, color, lineW, alpha=1){
    ctx.globalAlpha = alpha;
    ctx.strokeStyle = color;
    ctx.lineWidth = lineW * Math.min(2, window.devicePixelRatio||1);
    ctx.beginPath();
    E.forEach(([a,b])=>{
      const [x1,y1]=verts[a], [x2,y2]=verts[b];
      ctx.moveTo(x1,y1); ctx.lineTo(x2,y2);
    });
    ctx.stroke();
  }

  function drawCube(ctx, canvas, rot, pos=[0,0,0], scale=1, color=DARK, line=1.6, alpha=1){
    const vv = computeVerts(pos, rot, scale, canvas.width, canvas.height);
    strokeEdges(ctx, vv, color, line, alpha);
  }

  // ===== IDEACIÓN (se mantiene) =====
  makeCanvasRunner(document.getElementById('cv-idea'), (ctx, canvas, t)=>{
    const T = t*0.0001;
    const cubes = [
      {pos:[-2.8,-1.2,0], rot:[T*1.00, T*0.70, 0]},
      {pos:[ 2.8,-1.2,0], rot:[T*0.60, T*0.35, 0]},
      {pos:[-2.8, 1.2,0], rot:[T*0.50, T*0.95, 0]},
      {pos:[ 2.8, 1.2,0], rot:[T*0.85, T*0.30, 0]}
    ];
    cubes.forEach((c,i)=>{
      const yFloat = Math.sin(T*2 + i)*0.28;
      drawCube(ctx, canvas, c.rot, [c.pos[0],c.pos[1]+yFloat,0], 1);
    });
  });

  // ===== REFINAMIENTO (nuevo): giro -> pausa -> giro (loop seamless) + destello sutil =====
  makeCanvasRunner(document.getElementById('cv-refine'), (ctx, canvas, t)=>{
    const period = 5200;            // ms
    const spinFrac = 0.55;          // % del ciclo girando
    const tt = (t % period) / period;

    // progreso dentro de la parte "giro" (0..1), fuera de ella queda congelado
    let angleX = 0, angleY = 0;
    if (tt < spinFrac) {
      const p = easeInOutSine(tt / spinFrac);     // acelera y frena
      const osc = Math.sin(Math.PI * p);          // 0 -> 1 -> 0 (vuelve al origen)
      const A = 0.9;                               // amplitud (rad)
      angleX = 0.25 + osc * A * 0.65;
      angleY = 0.55 + osc * A;
      // Destello sólo en arranque del giro (p≈0)
      const flash = Math.max(0, 1 - (p*12));      // ventana muy corta
      if (flash > 0.001){
        const vv = computeVerts([0,0,0], [angleX,angleY,0.12], 1.05, canvas.width, canvas.height);
        for(let i=1;i<=3;i++){
          strokeEdges(ctx, vv, DARK, 1.6 + i*1.0, 0.10 * flash * (1/i));
        }
      }
    } else {
      // Pausa en orientación "neutra"
      angleX = 0.25;
      angleY = 0.55;
    }

    drawCube(ctx, canvas, [angleX, angleY, 0.12], [0,0,0], 1.05);
  });

  // ===== DIFUSIÓN (se mantiene) =====
  makeCanvasRunner(document.getElementById('cv-diffuse'), (ctx, canvas, t)=>{
    const w = canvas.width, h = canvas.height;
    const T = t*0.00010;
    const cubeScale = 0.99;
    const pxSize = Math.min(w,h)*0.07*cubeScale;
    const R = Math.min(w,h)/2/Math.min(2.3, 2.6) + pxSize*0.15;
    const N = Math.max(8, Math.floor((2*Math.PI*R) / (10.9*pxSize)));
    const ringAngle = T*0.15;

    for(let i=0;i<N;i++){
      const a = ringAngle + (i/N)*Math.PI*2;
      const ux = Math.cos(a) * (R / (Math.min(w,h)*0.07));
      const uy = Math.sin(a) * (R / (Math.min(w,h)*0.07));
      const dir = i%2===0 ? 1 : -1;
      const rot = [T*0.6*dir + i*0.03, T*0.4*dir, 0];
      drawCube(ctx, canvas, rot, [ux, uy, 0], cubeScale);
    }
  });
})();
</script>





</body>
</html>
